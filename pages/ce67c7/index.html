<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>杂乱无章 | Qouson&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/logo.png">
    <meta name="description" content="Java技术博客,专注Java学习与总结。">
    <meta name="keywords" content="Java后端博客,个人技术博客,后端,后端开发,后端框架,web后端,后端面试题,技术文档,学习,面试,Spring,Spring MVC,Spring Boot,Mybatis,Redis,Kafka,Zookeeper,Dubbo,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.7c783487.css" as="style"><link rel="preload" href="/assets/js/app.001dee7f.js" as="script"><link rel="preload" href="/assets/js/2.9f32b1ef.js" as="script"><link rel="preload" href="/assets/js/67.d9e67130.js" as="script"><link rel="prefetch" href="/assets/js/10.bf6bdccb.js"><link rel="prefetch" href="/assets/js/11.1abb3dd1.js"><link rel="prefetch" href="/assets/js/12.25097659.js"><link rel="prefetch" href="/assets/js/13.83164ea2.js"><link rel="prefetch" href="/assets/js/14.1e2f205b.js"><link rel="prefetch" href="/assets/js/15.46f653de.js"><link rel="prefetch" href="/assets/js/16.0219790a.js"><link rel="prefetch" href="/assets/js/17.c14d2772.js"><link rel="prefetch" href="/assets/js/18.d6e867d4.js"><link rel="prefetch" href="/assets/js/19.bec4eb52.js"><link rel="prefetch" href="/assets/js/20.301c9423.js"><link rel="prefetch" href="/assets/js/21.6c3b3934.js"><link rel="prefetch" href="/assets/js/22.f1ae2c75.js"><link rel="prefetch" href="/assets/js/23.f7a6d7ce.js"><link rel="prefetch" href="/assets/js/24.01a394c9.js"><link rel="prefetch" href="/assets/js/25.168f6a5c.js"><link rel="prefetch" href="/assets/js/26.f3699aa4.js"><link rel="prefetch" href="/assets/js/27.c3e90915.js"><link rel="prefetch" href="/assets/js/28.51103a35.js"><link rel="prefetch" href="/assets/js/29.e1a6c8eb.js"><link rel="prefetch" href="/assets/js/3.a85d349d.js"><link rel="prefetch" href="/assets/js/30.d50c88f6.js"><link rel="prefetch" href="/assets/js/31.14e9be9d.js"><link rel="prefetch" href="/assets/js/32.4e38a35f.js"><link rel="prefetch" href="/assets/js/33.244884f2.js"><link rel="prefetch" href="/assets/js/34.ddc04cb8.js"><link rel="prefetch" href="/assets/js/35.e0abcbeb.js"><link rel="prefetch" href="/assets/js/36.80f619c9.js"><link rel="prefetch" href="/assets/js/37.46a9c9c6.js"><link rel="prefetch" href="/assets/js/38.b02394cc.js"><link rel="prefetch" href="/assets/js/39.96e566a4.js"><link rel="prefetch" href="/assets/js/4.d209647e.js"><link rel="prefetch" href="/assets/js/40.ff1ee370.js"><link rel="prefetch" href="/assets/js/41.4c52f4ff.js"><link rel="prefetch" href="/assets/js/42.63397116.js"><link rel="prefetch" href="/assets/js/43.0d87b11c.js"><link rel="prefetch" href="/assets/js/44.c4b6515c.js"><link rel="prefetch" href="/assets/js/45.520af4b4.js"><link rel="prefetch" href="/assets/js/46.6b651d08.js"><link rel="prefetch" href="/assets/js/47.2e2cc573.js"><link rel="prefetch" href="/assets/js/48.b023f265.js"><link rel="prefetch" href="/assets/js/49.10566b74.js"><link rel="prefetch" href="/assets/js/5.cca480c9.js"><link rel="prefetch" href="/assets/js/50.a9c6f297.js"><link rel="prefetch" href="/assets/js/51.72652a30.js"><link rel="prefetch" href="/assets/js/52.30da4f33.js"><link rel="prefetch" href="/assets/js/53.ae22272c.js"><link rel="prefetch" href="/assets/js/54.db657dae.js"><link rel="prefetch" href="/assets/js/55.6aa60f67.js"><link rel="prefetch" href="/assets/js/56.9e045727.js"><link rel="prefetch" href="/assets/js/57.37702dc8.js"><link rel="prefetch" href="/assets/js/58.387f648b.js"><link rel="prefetch" href="/assets/js/59.f5d96eac.js"><link rel="prefetch" href="/assets/js/6.82001ca2.js"><link rel="prefetch" href="/assets/js/60.bd741a9b.js"><link rel="prefetch" href="/assets/js/61.43bc986c.js"><link rel="prefetch" href="/assets/js/62.1794e555.js"><link rel="prefetch" href="/assets/js/63.086f3156.js"><link rel="prefetch" href="/assets/js/64.53ff57df.js"><link rel="prefetch" href="/assets/js/65.743b1eb9.js"><link rel="prefetch" href="/assets/js/66.291cc462.js"><link rel="prefetch" href="/assets/js/68.47a77e3d.js"><link rel="prefetch" href="/assets/js/69.02cdd084.js"><link rel="prefetch" href="/assets/js/7.fbb05d84.js"><link rel="prefetch" href="/assets/js/70.039c3c9e.js"><link rel="prefetch" href="/assets/js/71.7df7824f.js"><link rel="prefetch" href="/assets/js/72.b97f78b1.js"><link rel="prefetch" href="/assets/js/73.03a0a0fb.js"><link rel="prefetch" href="/assets/js/74.de7b90a9.js"><link rel="prefetch" href="/assets/js/75.d4acda13.js"><link rel="prefetch" href="/assets/js/76.a21fa6c2.js"><link rel="prefetch" href="/assets/js/77.bda8cd14.js"><link rel="prefetch" href="/assets/js/78.c0c6cec9.js"><link rel="prefetch" href="/assets/js/79.85937016.js"><link rel="prefetch" href="/assets/js/8.417abde4.js"><link rel="prefetch" href="/assets/js/80.dc8c5c6c.js"><link rel="prefetch" href="/assets/js/81.6119b7d5.js"><link rel="prefetch" href="/assets/js/82.afae6245.js"><link rel="prefetch" href="/assets/js/83.24d9bbe3.js"><link rel="prefetch" href="/assets/js/84.426d42e8.js"><link rel="prefetch" href="/assets/js/85.df3568fa.js"><link rel="prefetch" href="/assets/js/86.ca7630d7.js"><link rel="prefetch" href="/assets/js/87.20510d21.js"><link rel="prefetch" href="/assets/js/88.78063b5a.js"><link rel="prefetch" href="/assets/js/9.462a7edb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7c783487.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Qouson's blog" class="logo"> <span class="site-name can-hide">Qouson's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java SE" class="dropdown-title"><a href="/java/" class="link-title">Java SE</a> <span class="title" style="display:none;">Java SE</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java 基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/standard/" class="nav-link">基础</a></li><li class="dropdown-subitem"><a href="/java/string/" class="nav-link">String</a></li></ul></li><li class="dropdown-item"><h4>Java 中级</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/net/" class="nav-link">网络编程</a></li></ul></li><li class="dropdown-item"><h4>Java 高级</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/jvm/" class="nav-link">JVM</a></li><li class="dropdown-subitem"><a href="/java/thread/" class="nav-link">多线程</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring框架" class="dropdown-title"><a href="/spring/" class="link-title">Spring框架</a> <span class="title" style="display:none;">Spring框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/spring/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/spring/springmvc/" class="nav-link">SpringMVC</a></li><li class="dropdown-item"><!----> <a href="/spring/springboot/" class="nav-link">SpringBoot</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/midware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/midware/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/midware/redis/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/midware/mq/" class="nav-link">MQ</a></li><li class="dropdown-item"><!----> <a href="/midware/zookeeper/" class="nav-link">ZooKeeper</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/more/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/more/designpattern/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/more/datastructure/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/more/computerscience/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/more/javaframework/" class="nav-link">Java相关框架</a></li><li class="dropdown-item"><!----> <a href="/more/distribute/" class="nav-link">分布式</a></li><li class="dropdown-item"><!----> <a href="/more/ddd/" class="nav-link">DDD领域驱动设计</a></li><li class="dropdown-item"><!----> <a href="/more/systemdesign/" class="nav-link">系统设计</a></li><li class="dropdown-item"><!----> <a href="/more/chaos/" class="nav-link">杂乱无章</a></li></ul></div></div><div class="nav-item"><a href="/javamap/" class="nav-link">Java知识图谱</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/qouson/my-java-note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="img/lunhua.png"> <div class="blogger-info"><h3>qouson</h3> <span>Java界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java SE" class="dropdown-title"><a href="/java/" class="link-title">Java SE</a> <span class="title" style="display:none;">Java SE</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java 基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/standard/" class="nav-link">基础</a></li><li class="dropdown-subitem"><a href="/java/string/" class="nav-link">String</a></li></ul></li><li class="dropdown-item"><h4>Java 中级</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/net/" class="nav-link">网络编程</a></li></ul></li><li class="dropdown-item"><h4>Java 高级</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/jvm/" class="nav-link">JVM</a></li><li class="dropdown-subitem"><a href="/java/thread/" class="nav-link">多线程</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring框架" class="dropdown-title"><a href="/spring/" class="link-title">Spring框架</a> <span class="title" style="display:none;">Spring框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/spring/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/spring/springmvc/" class="nav-link">SpringMVC</a></li><li class="dropdown-item"><!----> <a href="/spring/springboot/" class="nav-link">SpringBoot</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/midware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/midware/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/midware/redis/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/midware/mq/" class="nav-link">MQ</a></li><li class="dropdown-item"><!----> <a href="/midware/zookeeper/" class="nav-link">ZooKeeper</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/more/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/more/designpattern/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/more/datastructure/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/more/computerscience/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/more/javaframework/" class="nav-link">Java相关框架</a></li><li class="dropdown-item"><!----> <a href="/more/distribute/" class="nav-link">分布式</a></li><li class="dropdown-item"><!----> <a href="/more/ddd/" class="nav-link">DDD领域驱动设计</a></li><li class="dropdown-item"><!----> <a href="/more/systemdesign/" class="nav-link">系统设计</a></li><li class="dropdown-item"><!----> <a href="/more/chaos/" class="nav-link">杂乱无章</a></li></ul></div></div><div class="nav-item"><a href="/javamap/" class="nav-link">Java知识图谱</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/qouson/my-java-note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java相关框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DDD领域驱动设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>系统设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DevOps</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>杂乱无章</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ce67c7/" aria-current="page" class="active sidebar-link">杂乱无章</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/ce67c7/#更新2024-12-26" class="sidebar-link">更新2024-12-26</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ce67c7/#流程图测试" class="sidebar-link">流程图测试</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ce67c7/#更新2024-12-26-2" class="sidebar-link">更新2024-12-26</a></li><li class="sidebar-sub-header level2"><a href="/pages/ce67c7/#更新2025-01-02" class="sidebar-link">更新2025-01-02</a></li><li class="sidebar-sub-header level2"><a href="/pages/ce67c7/#更新2025-01-03" class="sidebar-link">更新2025-01-03</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ce67c7/#verify-验证是确认在模拟过程中-被测试方法是否按预期方式与其任何依赖方法进行了交互。" class="sidebar-link">verify：验证是确认在模拟过程中，被测试方法是否按预期方式与其任何依赖方法进行了交互。</a></li><li class="sidebar-sub-header level3"><a href="/pages/ce67c7/#powermockito的mock和spy的区别" class="sidebar-link">PowerMockito的mock和spy的区别：</a></li><li class="sidebar-sub-header level3"><a href="/pages/ce67c7/#单元测试断言" class="sidebar-link">单元测试断言</a></li><li class="sidebar-sub-header level4"><a href="/pages/ce67c7/#单元测试必须断言" class="sidebar-link">单元测试必须断言</a></li><li class="sidebar-sub-header level4"><a href="/pages/ce67c7/#单元测试断言的方式" class="sidebar-link">单元测试断言的方式</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/more/#更多" data-v-06225672>更多</a></li><li data-v-06225672><a href="/more/#杂乱无章" data-v-06225672>杂乱无章</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/qouson" target="_blank" title="作者" class="beLink" data-v-06225672>qouson</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-12-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">杂乱无章<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="杂乱无章"><a href="#杂乱无章" class="header-anchor">#</a> 杂乱无章</h1> <h2 id="更新2024-12-26"><a href="#更新2024-12-26" class="header-anchor">#</a> 更新2024-12-26</h2> <h3 id="流程图测试"><a href="#流程图测试" class="header-anchor">#</a> 流程图测试</h3> <div class="language-mermaid line-numbers-mode"><pre class="language-mermaid"><code><span class="token keyword">graph</span> TD
  A<span class="token text string">(开始)</span> <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">just test</span> <span class="token arrow operator">--&gt;</span></span> B<span class="token text string">{是否符合}</span>
  B <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">yes</span> <span class="token arrow operator">--&gt;</span></span> C
  B <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">no</span> <span class="token arrow operator">--&gt;</span></span> D
  C <span class="token arrow operator">--&gt;</span> E<span class="token text string">(结束)</span>
  D <span class="token arrow operator">--&gt;</span> E<span class="token text string">(结束)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>https://wx.zsxq.com/group/51121241882444/topic/4848544415524848

覆盖率
单元测试
集成测试
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="更新2024-12-26-2"><a href="#更新2024-12-26-2" class="header-anchor">#</a> 更新2024-12-26</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>一般用Junit+Mockito+PowerMockito

T PowerMockito.mock(Class clazz):
用途：用于模拟指定类的对象实例。
当模拟非final类（接口，普通类，虚基类）的非final方法时，不必使用@RunWith和@PrepareForTest注解。
当模拟final类或final方法时，必须使用@RunWith(PowerMockRunner.class)和@PrepareForTest({StringUtils.class})注解

PowerMockito.mockStatic(Class clazz);
用途：用于模拟类的静态方法，必须使用@RunWith(PowerMockRunner.class)和@PrepareForTest({StringUtils.class})注解

一个简单的例子：
public class ListTest{
    @Test
    public void testSize(){
        Integer expected = 100;
        List list = PowerMockito.mock(List.class);
        PowerMockito.when(list.size()).thenReturn(expected);
        Integer actual = list.size();
        Assert.assertEquals(&quot;返回值不相等&quot;, expected, actual);    
     }
}

mock语句
mock方法
声明：T PowerMockito.mock(Class clazz)：用途：用于模拟指定类的对象实例。
当模拟非final类（接口，普通类，虚基类）的非final方法时，不必使用@RunWith和@PrepareForTest注解。）
当模拟final类或final方法时，必须使用@RunWith(PowerMockRunner.class)和@PrepareForTest({StringUtils.class})注解

模拟非final类普通方法
public class Rectangle implements Shape{
    private double width;
    private double height;
    @Override
    public double getArea(){
        return width * height;
    }
}
public class RectangleTest{
    @Test
    public void testGetArea(){
        double expectArea = 100.0D;
        Rectangle rectangle = PowerMockito.mock(Rectangle.class);
        PowerMockito.when(rectangle.getArea()).thenReturn(expectArea);)
        double actual = rectangle.getArea();
        Assert.assertEquals(&quot;返回值不相等&quot;, expectArea, actual);
    }
}

模拟final类或final方法
需要使用@RundWith(PowderMockRunner.class)和@PrepareForTest({Circle.class})注解
public final class Circle{
    private double radius;
    public double getArea(){
        return Math.PI * Math.pow(radius, 2);
    }
}
@RunWith(PowerMockRunner.class)
@PrepareForTest({Circle.class})
public class CircleTest{
    @Test
    public void testGetArea(){
        double expectArea = 100.0D;
        Circle circle = PowerMockito.mock(Circle.class);
        PowerMockito.when(circle.getArea()).thenReturn(expectArea);
        double actual = circle.getArea();
        Assert.assertEquals(&quot;返回值不相等&quot;, expectArea, actual);
    }
}

mockStatic方法
PowerMockito.mockStatic(Class clazz)：用途：用于模拟类的静态方法，必须使用@RunWith(PowerMockRunner.class)和@PrepareForTest({StringUtils.class})注解
@RunWith(PowerMockRunner.class)
@PrepareForTest({StringUtils.class})
public class StringUtilsTest{
    @Test
    public void testIsEmpty(){
        String string = &quot;abc&quot;;
        boolean expected = true;
        PowerMockito.when(StringUtils.class);
        PowerMockito.when(StringUtils.isEmpty(string)).thenReturn(expected);
        boolean actual = StringUtils.isEmpty(string); // 这里调用时，就会发现是返回的mock数据
        Assert.assertEquals(&quot;返回值不相等&quot;, expected, actual);
    }
}


spy语句：
如果一个对象，我们只希望模拟它的部分方法，而希望其他方法跟原来一样，可以使用PowerMockito.spy方法替代PowerMockito.mock方法。
通过when设置过的方法，调用的是模拟方法，没有通过when语句的调用的是原来的方法
powerMock又两种使用，一种是非注解，一种是注解注入的。
Spy类（非注解）：
PowerMockito.spy(StringUtils.class)
PowerMockito.when(StringUtils.isEmpty(string)).thenReturn(!expected)
例子：
spy对象（非注解）：
声明：T PowerMockito.spy(T object)：用途：用于模拟对象的部分方法，如UserService类要测试isNotSuperUser方法，但是要mock掉isSupperUser这个方法，就需要对这个类加个spy，注解为@RunWith(PowderMockRunner.class)
案例：
public class UserService{
    private Long superUserId;
    public boolean isNotSuperUser(Long userId){
        return !isSuperUser(userId);
    }
    public boolean isSuperUser(Long userId){
        return Objects.equals(userId, superUserId);
    }
}

@RunWith(PowerMockRunner.class)
public class UserServiceTest{
    @Test
    public void testIsNotSuperUser(){
        Long userId = 1L;
        boolean expected = false;
        UserService userService = PowerMockito.spy(UserService.class);
        PowerMockito.when(userService.isSuperUser(userId)).thenReturn(!expected);
        boolean actual = userService.isNotSuperUser(userId);
        Assert.assertEquals(&quot;返回值不相等&quot;, expected, actual);
    }
}


注解：使用InjectMocks注解注入的方式，使用@Spy
@RundWith(PowerMockRunner.class)
public class UserServiceTest{
    @Spy
    @InjectMocks
    private UserService userServiceSpy = new UserService();
    @Test
    public void testIsNotSuperUser(){
        Long userId = 1L;
        boolean expected = false;
        // 不要使用这种方法是，会先调用方法再mock
        // PowerMockito.when(userServiceSpy).isSuperUser(userId);
        // 这种方式就不会先调用方法
        // 直接使用userId是强匹配，使用any()是所有参数都匹配
        doReturn(!expected).when(userServiceSpy).isSuperUser(userId);
        boolean actual = userService.isNotSuperUser(userId);
        Assert.assertEquals(&quot;返回值不相等&quot;, expected, actual);
    }
}


when语句
when().thenReturn()
声明：
PowerMockito.when(mockObject.someMethod(someArgs)).thenReturn(expectedValue);
PowerMockito.when(mockObject.someMethod(someArgs)).thenThrow(expectedThrowable);
PowerMockito.when(mockObject.someMethod(someArgs)).thenAnswer(expectedAnswer);
PowerMockito.when(mockObject.someMethod(someArgs)).thenCallRealMethod();
用途：用于模拟对象方法，先执行原始放啊，再返回期望的值，异常，应答，或调用真实方法。

doReturn().when()
模式
声明：
Powermockito.doReturn(expectedValue).when(mockObject).someMethod(someArgs);
PowerMockito.doThrow(expectedThrowable).when(mockObject).someMethod(someArgs);
PowerMockito.doAnswer(expectedAnswer).when(mockObject).someMethod(someArgs);
PowerMockito.doNothing().when(mockObject).someMethod(someArgs);
PowerMockito.doCallRealMethod().when(mockObject).someMethod(someArgs);
用途：用于模拟对象方法，直接返回期望值的值，异常，应答，或调用真实方法。无需执行原始方法。
注意：千万不要使用以下语法：
PowerMockito.doReturn(expectedValue).when(mockObject.someMethod(someArgs));
PowerMockito.doThrow(expectedThrowable).when(mockObject.someMethod(someArgs));
PowerMockito.doAnswer(expectedAnswer).when(mockObject.someMethod(someArgs));
PowerMockito.doNothing().when(mockObject.someMethod(someArgs));
PowerMockito.doCallRealMethod().when(mockObject.someMethod(someArgs));
虽然不会出现编译错误，但是在执行时会抛出UnfinishedStubbingException异常。

两种模式的主要区别：
两种模式都用于模拟对象方法，在mock实例下使用时，基本上没有差别。但是在spy实例下使用，when().thenReturn()会先执行原方法，而doReturn().when()不会执行原方法。


whenNew模拟构造方法
声明：
PowerMockito.whenNew(MockClass.class).withNoArguments().thenReturn(expectedObject);
PowerMockito.whenNew(MockClass.class).withArguments(someArgs).thenReturn(expectedObject);

用途：用于模拟构造方法。案例：
public final class FileUtils{
    public static boolean isFile(Sting fileName){
        return new File(fileName).isFile();
    }
}
@RunWith(PowerMockRunner.class)
@PrepareForTest(FileUtils.class)
public class FileUtilsTest{
    @Test
    public void testIsFile() throws Exception{
        String fileName = &quot;test.txt&quot;;
        File file = PowerMockito.mock(File.class);
        PowerMockito.whenNew(File.class).withArguments(fileName).thenReturn(file);
        PowerMockito.when(file.isFile()).thenReturn(true);
        Assert.assertTrue(&quot;返回值为假&quot;,FileUtils.isFile(fileName));
    }
}
注意：需要加上注解@PrepareForTest(FileUtils.class)，否则模拟方法不生效。


参数匹配器：
在执行单元测试时，有时候不关心传入的参数的值，可以使用参数匹配器。
注意：你能具体到指定类型如anyString，anyInt，就不用any()。null值必须显式用null，或eq(null)来匹配

参数匹配器(any)
Mockito提供Mockito.anyInt(),Mockito.anyString,Mockito.any(Class clazz)来表示任何值。
public class ListTest{
    @Test
    public void testGet(){
        int index = 1;
        Integer expcected = 100;
        List&lt;Integer&gt; mockList = PowerMockito.mock(List.class);
        PowerMockito.when(mockList.get(Mockito.anyInt())).thenReturn(expcected);
        Integer actual = mockList.get(index);
        Assert.assertEquals(&quot;返回值不相等&quot;, expcected, actual);
    }
}


参数匹配器(eq)
当我们使用参数匹配器时，所有参数都应使用匹配器。如果要为某一参数指定特定值时，就需要使用Mockito.eq()方法。
@Runwith(PowerMockRunner.class)
@PrepareForTest(StringUtils.class)
public class StringUtilsTest{
    @Test
    public void testStartWith(){
        String string = &quot;abc&quot;;
        String perfix = &quot;b&quot;;
        boolean expected = true;
        PowerMockito.spy(StringUtils.class);
        PowerMockito.when(StringUtils.startWith(Mockito.anyString(),Mockito.eq(prefix))).thenReturn(expected);
        boolean actual = StringUtils.startsWith(string,perfix);
        Assert.assertEquals(&quot;返回值不相等&quot;, expected, actual);
    }
}


附加匹配器
Mockito的AdditionalMathchers类提供了一些很少使用的参数匹配器，我们可以进行参数大于(gt)、小于(lt)、大于等于(geq)、小于等于(leq)等比较操作，也可以进行参数与(and)、或(or)、非(not)等逻辑操作。
public class ListTest{
    @Test
    public void testGet(){
        int index = 1;
        Integer expected = 100;
        List&lt;Integer&gt; mockList =PowerMockito.mock(List.class);
        PowerMockito.when(mockList.get(AdditionalMatchers.geq(0))).thenReturn(expected);
        PowerMockito.when(mockList.get(AdditionalMatchers.lt(0))).thenThrow(new IndexOutOfBoundsException());
        Intger actual = mockList.get(index);
        Assert.assertEquals(&quot;返回值不相等&quot;, expected, actual);
    }
}


verify语句
验证是确认在模拟过程中，被测试方法是否已按预期方式与其任何依赖方法进行了交互。
格式：
Mockito.verify(mockObject[,times(int)]).someMethod(someArgs);
用途：
用于模拟对象方法，直接返回预期的值，异常，应答，或调用真实方法。
案例：
验证调用方法
public classLi身体Test{
    @Test
    public void testGet（）{
        List&lt;Iteger&gt; mockList= PowerMockito.mock(List.class);
        PowerMockito.doNothing().when(mockList).clear();
        mockList.clear();
        Mockito.verify(mockList).clear();
    }
}

public class ListTest{
    @Test
    public void testGet(){
        List&lt;Integer&gt; mockList = PowerMockito.mock(List.class);
        PowerMockito.doNothing().when(mockList).clear();
        mockList.clear();
        Mockito.verify(mockList,Mockito.times(1)).clear();
    }
}
除times外，Mockito还支持atLeastOne，atLeast，only，atMostOnce，atMost等次数验证器


验证调用顺序
public class ListTest{
    @Test
    public void testAdd(){
        List&lt;Integer&gt; mockList = PowerMockito.mock(List.class);
        PowerMockito.doReturn(true).when(mockList).add(Mockito.anyInt());
        mockedList.add(1);
        mockedList.add(2);
        mockedList.add(3);
        InOrder inOrder = Mockito.inOrder(mockList);
        inOrder.verify(mockList).add(1);
        inOrder.verify(mockList).add(2);
        inOrder.verify(mockList).add(3);
    }
}


验证调用参数
用于断言void方法，没有返回结果，可以断言内部调用的请求参数
public class ListTest{
    @Test
    public void testArgumentCaptor(){
        Integer[] expecteds = new Integer[]{1,2,3};
        List&lt;Integer&gt; mockedList = PowerMockito.mock(List.class);
        PowerMockito.doReturn(true).when(mockedList).add(Mockito.anyInt());
        for(Integer expected : expecteds){
            mockedList.add(expected);
        }
        ArgumentCaptor&lt;Integer&gt; argumentCaptor = ArgumentCaptor.forClass(Integer.class);
        Mockito.verify(mockedList,Mockito.times(3)).add(argumentCaptor.capture());
        Integer[] actuals = argumentCaptor.getAllValues().toArray(new Integer[0]);
        Assert.assertArrayEquals(&quot;参数不相等&quot;,expecteds,actuals);
    }
}


确保验证完毕
Mockito提供Mockito.verifyNoMoreInteractions方法，在所有验证方法之后可以使用此方法，以确保所有调用都得到验证。如果模拟对象上存在未验证的调用，将会抛出NoInteractionsWanted异常。
public class ListTest{
    @Test
    public void testVerifyNoMoreInteractions(){
        List&lt;Integer&gt; mockedList = PowerMockito.mock(List.class);
        Mockito.verifyNoMoreInteractions(mockedList);//执行正常呢
        mockedList.isEmpty();
        Mockito.verifyNoMoreInteractions(mockedList);//抛出异常
    }
}
备注：Mockito.verifyZeroInteractions(mockedList)与Mockito.verifyNoMoreInteractions(mockedList)效果相同，但目前已经被废弃。


验证静态方法
Mockito没有静态方法的验证方法，但是PowerMockito提供了静态方法的验证方法。注意：@RunWith(PowerMockRunner.class)和@PrepareForTest(StaticClass.class)
@Runwith(PowerMockRunner.class)
@PrepareForTest(StringUtils.class)
public class StringUtilsTest{
    @Test
    public void testVerifyStatic(){
        PowerMockito.spy(StringUtils.class);
        String expected = &quot;abc&quot;;
        StringUtils.isEmpty(expected);
        PowerMockito.verifyStatic(StringUtils.class);
        ArgumentCaptor&lt;String&gt; argumentCaptor = ArgumentCaptor.forClass(String.class);
        StringUtils.isEmpty(argumentCaptor.capture());
        Assert.assertEquals(&quot;参数不相等&quot;,expected,argumentCaptor.getValue());
    }
}


私有属性
ReflectionTestUtils.setField方法
在用原生JUnit进行单元测试时，我们一般采用ReflectionTestUtils.setField方法来设置私有属性。
@Service
public class UserService{
    @Value(&quot;${system.userLimit}&quot;)
    private Long userLimit;
    public Long getUserLimit(){
        return userLimit;
    }
}
public class UserServiceTest{
    @Autowired
    private UserService userService;
    @Test
    public void testGetUserLimit(){
        Long expected = 1000L;
        ReflectionTestUtils.setField(userService,&quot;userLimit&quot;,expected);
        Long actual = userService.getUserLimit();
        Assert.assertEquals(&quot;返回值不相等&quot;,expected,actual);
    }
}
注意：在测试类中，UserService实例是通过@Autowired注解加载的，如果该实例已经被动态代理，ReflectionTestUtils。setField方法设置的是代理实例，从而导致设置不生效。


Whitebox.setInternalState方法
现在使用PowerMock进行单元测试时，可以采用Whitebox.setInternalState方法设置私有属性值。注意：@RunWith(PowerMockRunner.class)
@Service
public class UserService{
    @Value(&quot;${system.userLimit}&quot;)
    private Long userLimit;
    public Long getUserLimit(){
        return userLimit;
    }
}
@RunWith(PowerMockRunner.class)
public class UserServiceTest{
    @InjectMocks
    private UserService userService;
    @Test
    public void testGetUserLimit(){
        Long expected = 1000L;
        Whitebox.setInternalState(userService,&quot;userLimit&quot;,expected);
        Long actual = userService.getUserLimit();
        Assert.assertEquals(&quot;返回值不相等&quot;,expected,actual);
    }
}
注意：需要加上注解@RunWith(PowerMockRunner.class)


私有方法
模拟私有方法
Mockito没有私有方法的mock方法，但是PowerMockito提供了私有方法的模拟方法。注意：@RunWith(PowerMockRunner.class)和@PrepareForTest(UserService.class)，mock私有方法入参不要使用匹配器，可能会导致匹配失败。
通过when实现
public class UserService{
    private Long superUserId;
    public boolean isNotSupperUser(Long userId){
        return !isSupperUser(userId);
    }
    private boolean isSuppperUser(Long userId){
        return Objects.equals(userId,superUserId);
    }
}
@RunWith(PowerMockRunner.class)
@PrepareForTest(UserService.class)
public class UserServiceTest{
    @Test
    public void testIsNotSupperUser() throws Exception{
        Long userId = 1L;
        boolean expected = false;
        UserService userService = PowerMockito.spy(new UserService());
        PowerMockito.when(userService, &quot;isSuppperUser&quot;, userId).thenReturn(expected);
        boolean actual = userService.isNotSupperUser(userId);
        Assert.assertEquals(&quot;返回值不相等&quot;,expected,actual);
    }
}


通过stub实现
通过模拟方法stub(存根)，也可以实现模拟私有方法。但是，只能模拟整个方法的返回值，不能模拟指定参数的返回值。
@RunWith(PowerMockRunner.class)
@PrepareForTest(UserService.class)
public class UserServiceTest{
    @Test
    public void testIsNotSupperUser() throws Exception{
        Long userId = 1L;
        boolean expected = false;
        UserService userService = PowerMockito.spy(new UserService());
        PowerMockito.stub(PowerMockito.method(UserService.class,&quot;isSuppperUser&quot;)).toReturn(expected);
        boolean actual = userService.isNotSupperUser(userId);
        Assert.assertEquals(&quot;返回值不相等&quot;,expected,actual);
    }
}


测试私有方法
@RunWith(PowerMockRunner.class)
public class UserServiceTest{
    @Test
    public void testIsSupperUser() throws Exception{
        Long userId = 1L;
        boolean expected = false;
        UserService userService = new UserService();
        Method method = PowerMockito.method(UserService.class,&quot;isSuppperUser&quot;, Long.class);
        Object actual = method.invoke(userService,userId);
        Assert.assertEquals(&quot;返回值不相等&quot;,expected,actual);
    }
}


验证私有方法
@RunWith(PowerMockRunner.class)
@PrepareForTest(UserService.class)
public class UserServiceTest{
    @Test
    public void testIsNotSupperUser() throws Exception{
        Long userId = 1L;
        boolean expected = false;
        UserService userService = PowerMockito.spy(new UserService());
        PowerMockito.when(userService, &quot;isSuppperUser&quot;, userId).thenReturn(expected);
        boolean actual = userService.isNotSupperUser(userId);
        PowerMockito.verifyPrivate(userService).invoke(&quot;isSuppperUser&quot;,userId);
        Assert.assertEquals(&quot;返回值不相等&quot;,expected,actual);
    }
}
这里，也可以用Method那套方法进行模拟和验证方法。


主要注解：
PowerMock为了更好地支持SpringMVC/SpringBoot项目，提供了一系列注解，大大简化测试代码。

@RunWith注解，指定JUnit使用PowerMock框架中的单元测试运行器。

@PrepareForTest注解，指定需要模拟final类，final方法或静态方法。如果需要指定多个类，在{}中添加多个类并用逗号隔开。

@Mock注解，创建了一个全部Mock的实例，所有属性和方法全被置空（0或null）。通常可以加上@Mock(lenient = true)防止mock未使用而报错。

@Spy注解，创建了一个没有Mock的实例，所有成员方法都会按照原方法逻辑执行，知道被Mock返回某个具体的值为止。注意：@Spy注解的变量需要被初始化，否则执行时抛出异常。

@InjectMocks注解，创建一个实例，这个实例可以调用真实代码，其余用@Mock或@Spy注解创建的实例将被注入到这个实例中。

@Captor注解，该注解在字段级别创建参数捕获器。但是，在测试方法启动前必须调用MockitoAnnotations.openMocks(this)进行初始化。

@PowerMockIgnore注解，为了解决使用PowerMock后，提示ClassLoader错误。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br><span class="line-number">451</span><br><span class="line-number">452</span><br><span class="line-number">453</span><br><span class="line-number">454</span><br><span class="line-number">455</span><br><span class="line-number">456</span><br><span class="line-number">457</span><br><span class="line-number">458</span><br><span class="line-number">459</span><br><span class="line-number">460</span><br><span class="line-number">461</span><br><span class="line-number">462</span><br><span class="line-number">463</span><br><span class="line-number">464</span><br><span class="line-number">465</span><br><span class="line-number">466</span><br><span class="line-number">467</span><br><span class="line-number">468</span><br><span class="line-number">469</span><br><span class="line-number">470</span><br><span class="line-number">471</span><br><span class="line-number">472</span><br><span class="line-number">473</span><br><span class="line-number">474</span><br><span class="line-number">475</span><br><span class="line-number">476</span><br><span class="line-number">477</span><br><span class="line-number">478</span><br><span class="line-number">479</span><br><span class="line-number">480</span><br><span class="line-number">481</span><br><span class="line-number">482</span><br><span class="line-number">483</span><br><span class="line-number">484</span><br><span class="line-number">485</span><br><span class="line-number">486</span><br><span class="line-number">487</span><br><span class="line-number">488</span><br><span class="line-number">489</span><br><span class="line-number">490</span><br><span class="line-number">491</span><br><span class="line-number">492</span><br><span class="line-number">493</span><br></div></div><h2 id="更新2025-01-02"><a href="#更新2025-01-02" class="header-anchor">#</a> 更新2025-01-02</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>spy:模拟对象的某些方法
用spy指定getServerIp方法的返回值
@InjectMocks
EmpFlowExecuteWork empFlowExecuteWork = new EmpFlowExecuteWork();
String serverIp = &quot;192.168.1.1&quot;;
EmpFlowExecuteWork spy = PowerMockito.spy(empFlowExecuteWork);
PowerMockito.doReturn(serverIp).when(spy,&quot;getServerIp&quot;);
String serverIpResult = spy.getServerIp();
Assert.assertEquals(&quot;参数不相等&quot;，serverIp,serverIpResult);

mockStatic:模拟静态方法
@RunWith(PowerMockRunner.class)
@PrepareForTest(EMPLog.class)
PowderMockito.mockStatic(EMPLog.class);
EMPLog.info(&quot;test&quot;);
PowerMockito.verifyStatic(EMPLog.class);
EMPLog.info(&quot;test&quot;);

whenNew模拟构造方法
@RunWith(PowerMockRunner.class)
@PrepareForTest(File.class)
PowderMockito.whenNew(File.class).withArguments(&quot;test&quot;).thenReturn(file);

调用私有方法
AlipayDetails AlipayDetails = new AlipayDetails();
Method method = PowerMockito.method(AlipayDetails.class,&quot;getAlipayDetails&quot;,String.class);
method.invoke(AlipayDetails,&quot;test&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="更新2025-01-03"><a href="#更新2025-01-03" class="header-anchor">#</a> 更新2025-01-03</h2> <h3 id="verify-验证是确认在模拟过程中-被测试方法是否按预期方式与其任何依赖方法进行了交互。"><a href="#verify-验证是确认在模拟过程中-被测试方法是否按预期方式与其任何依赖方法进行了交互。" class="header-anchor">#</a> verify：验证是确认在模拟过程中，被测试方法是否按预期方式与其任何依赖方法进行了交互。</h3> <h3 id="powermockito的mock和spy的区别"><a href="#powermockito的mock和spy的区别" class="header-anchor">#</a> PowerMockito的mock和spy的区别：</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>mock：模拟对象，模拟对象调用的方法，返回模拟值。
spy：包装一个已经存在的对象，先调用真实方法，当方法调用未定义才再调用模拟方法。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="单元测试断言"><a href="#单元测试断言" class="header-anchor">#</a> 单元测试断言</h3> <h4 id="单元测试必须断言"><a href="#单元测试必须断言" class="header-anchor">#</a> 单元测试必须断言</h4> <h4 id="单元测试断言的方式"><a href="#单元测试断言的方式" class="header-anchor">#</a> 单元测试断言的方式</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>1. Junit自带断言，用于判断两个值是否相等
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertEquals(expected,actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>2. Junit自带断言，用于判断数组容器是否相等
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertArrayEquals(expected,actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>3. Junit自带断言，用于判断Boolean是否为true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertTrue(actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>4. Junit自带断言，用于判断Boolean是否为false
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertFalse(actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>5. Junit自带断言，用于判断是同一个对象
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertSame(expected,actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>6. Junit自带断言，用于判断不是同一个对象
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertNotSame(expected,actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>7. Junit自带断言，用于判断对象是否为null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertNull(actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>8. Junit自带断言，用于判断对象是否不为null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertNotNull(actual)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>9. Junit自带断言，用于判断参数值是否匹配规则
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>assertThat(actual,matcher)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>10. Junit自带断言，天狼星框架
通过WriteLogUtil类中的printAssertionErrorAndException来统一输出错误断言信息和异常信息
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>
11. expect，expectMessage
通过Junit中ExpectedException类对象，来断言期望的异常类对象和详细的异常信息
@Rule
public ExpectedException exRule = ExpectedException.none();
// 断言是否为BizExceptioin
exRule.expect(BizException.class);
// 断言返回具体的异常信息
exRule.expectMessage(&quot;&quot;);

12. verify
Mockito中检查是否发生了某些行为
Mockito.verify(mockObj, mock.times(1)).method(any());
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>// 被测方法，Controller层syncOrderStatus方法
public void syncOrderStatus(){
// 验证syncOrderStatus的调用次数
orderStatusSyncService.syncOrderStatus();
}
// 被测方法
@Test
public void unionOrderStatusSyncTest(){
PowderMockito.doNothing().when(orderStatusSyncService).syncOrderStatus();
// 获取mockObj
OrderStatusSyncService orderStatusSyncService = PowderMockito.mock(OrderStatusSyncService.class);
orderStatusSyncController.syncOrderStatus();
// orderStatusSyncService为mock对象，Mockito.times(1)为调用次数；syncOrderStatus为mock对象中调用的方法
Mockito.verify(orderStatusSyncService, Mockito.times(1)).syncOrderStatus();
}</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
13. andExpected
MockMvc单元测试
- mockMvc.perform 执行一个请求
- MockMvcRequestBuilders.get 创建一个请求
- ResultActions.param添加请求传值
- ResultActions.accept(MediaType.APPLICATION_JSON)设置返回类型
- ResultActions.andExpect添加执行完成后的断言
- ResultActions.andDo添加一个结果处理器，表示要对结果做点什么事情
- ResultActions.andReturn执行结果
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>MvcResult mvcResult = mockMvc.perform(MockMvcRequestBuilders
.get(&quot;/login&quot;)
.accept(MediaType.APPLICATION_JSON)
.param(&quot;name&quot;,&quot;&quot;)
.andExpect(status().isOk())
.andExpect(jsonPath(&quot;$.status&quot;).value(subMerchantAddResultVO.getStatus()))
.andDo(logging.info(&quot;&quot;))
.andReturn());</p> <p>例如：
// 被测类
public class HelloController {
@RequestMapping(&quot;/hello&quot;)
public String hello(){
return &quot;hello&quot;;
}
}</p> <p>// 测试方法
private MockMvc mvc = MockMvcBuilders.standaloneSetup(new HelloController()).build();</p> <p>@Test
public void helloTest() throws Exception {
mvc.perform(MockMvcRequestBuilders
.get(&quot;/hello&quot;)
.param(&quot;hello&quot;)
.accept(MediaType.APPLICATION_JSON))
.andExpect(content().string(&quot;hello&quot;))
}</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
14. verifyStatic，PowerMockito中用来验证Mock对象中静态方法是否执行的行为。
15. verifyPrivate，PowerMockito中用来验证Mock对象中私有方法是否执行的行为。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>PowderMockito.verifyPrivate(mockObj).invoke(method,argument)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>16. public接口无返回值如何断言
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol><li>断言方法执行次数
Mockito.verify(mockObj, Mockito.times(1)).method(argument);</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code> 
17. 捕获mock方法的调用参数，并进行断言，
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>@Test
public void argumentTest(){
List list = mock(List.class);
List list1 = mock(List.class);
List list2 = mock(List.class);
list.add(&quot;0&quot;);
list2.add(&quot;1&quot;);
list2.add(&quot;2&quot;);</p> <div class="language- extra-class"><pre><code>// 调用0次，无需断言参数，可直接断言次数
ArgumentCaptor&lt;String&gt; argumentCaptor = ArgumentCaptor.forClass(String.class);
verify(list3,times(0)).add(argumentCaptor.capture());

// 调用一次，断言参数
ArgumentCaptor&lt;String&gt; argumentCaptor1 = ArgumentCaptor.forClass(String.class);
verify(list).add(argumentCaptor1.capture());
assertEquals(&quot;0&quot;,argumentCaptor1.getValue());

// 调用多次，断言参数
ArgumentCaptor&lt;String&gt; argumentCaptor2 = ArgumentCaptor.forClass(String.class);
verify(list2,times(2)).add(argumentCaptor2.capture());
List listActual = argumentCaptor2.getAllValues();
assertEquals(&quot;1&quot;,listActual.get(0));
assertEquals(&quot;2&quot;,listActual.get(1));
</code></pre></div><p>}</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>

public long getTimestamp(String dateString) throws ParseException {
    if(StringUtils.isNotBlank(dateString)){
        SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);
        return sdf.parse(dateString).getTime();
    }
    return 0;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/qouson/my-java-note/edit/master/docs/40.更多/120.杂乱无章/10.杂乱无章.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/01/20, 17:53:43</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/15c4be/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">python</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/15c4be/" class="prev">python</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/fb8108/"><div>
            基础-大彬
            <!----></div></a> <span class="date">11-14</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/b31312/"><div>
            集合-大彬
            <!----></div></a> <span class="date">11-14</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/3b591d/"><div>
            MySQL_xiaolingcode
            <!----></div></a> <span class="date">11-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:jiangjinchao1642@foxmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/qouson" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2025
    <span>qouson</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.001dee7f.js" defer></script><script src="/assets/js/2.9f32b1ef.js" defer></script><script src="/assets/js/67.d9e67130.js" defer></script>
  </body>
</html>
